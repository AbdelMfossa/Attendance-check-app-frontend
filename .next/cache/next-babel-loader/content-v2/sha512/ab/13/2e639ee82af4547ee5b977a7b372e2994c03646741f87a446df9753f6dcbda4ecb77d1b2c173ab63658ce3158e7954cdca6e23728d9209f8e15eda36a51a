{"ast":null,"code":"import Router from \"next/router\";\nimport axios from \"axios\";\nexport const authInitialProps = isProtectedRoute => ({\n  req,\n  res\n}) => {\n  const auth = getSessionFromServer();\n  const currentPath = req ? req.url : window.location.pathname;\n  const user = auth.data;\n  const userId = user.id;\n  const isAnonymous = !user;\n\n  if (isProtectedRoute && isAnonymous && currentPath !== \"/signin\") {\n    return redirectUser(res, \"/signin\");\n  }\n\n  return {\n    auth,\n    userId\n  };\n};\nexport const getSessionFromServer = async () => {\n  const {\n    user\n  } = await axios.get(\"users/currentuser\");\n  return {\n    user\n  };\n};\n\nconst redirectUser = (res, path) => {\n  if (res) {\n    res.redirect(302, path);\n    res.finished = true;\n    return {};\n  }\n\n  Router.replace(path);\n  return {};\n};","map":{"version":3,"sources":["/home/roosvelt/Livrable front-end/Attendance-check-app-frontend-1/lib/auth.js"],"names":["Router","axios","authInitialProps","isProtectedRoute","req","res","auth","getSessionFromServer","currentPath","url","window","location","pathname","user","data","userId","id","isAnonymous","redirectUser","get","path","redirect","finished","replace"],"mappings":"AAAA,OAAOA,MAAP,MAAmB,aAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAO,MAAMC,gBAAgB,GAAIC,gBAAD,IAAsB,CAAC;AAAEC,EAAAA,GAAF;AAAOC,EAAAA;AAAP,CAAD,KAAkB;AACtE,QAAMC,IAAI,GAAGC,oBAAoB,EAAjC;AACA,QAAMC,WAAW,GAAGJ,GAAG,GAAGA,GAAG,CAACK,GAAP,GAAaC,MAAM,CAACC,QAAP,CAAgBC,QAApD;AACA,QAAMC,IAAI,GAAGP,IAAI,CAACQ,IAAlB;AACA,QAAMC,MAAM,GAAGF,IAAI,CAACG,EAApB;AACA,QAAMC,WAAW,GAAG,CAACJ,IAArB;;AACA,MAAIV,gBAAgB,IAAIc,WAApB,IAAmCT,WAAW,KAAK,SAAvD,EAAkE;AAChE,WAAOU,YAAY,CAACb,GAAD,EAAM,SAAN,CAAnB;AACD;;AACD,SAAO;AAAEC,IAAAA,IAAF;AAAQS,IAAAA;AAAR,GAAP;AACD,CAVM;AAYP,OAAO,MAAMR,oBAAoB,GAAG,YAAY;AAC9C,QAAM;AAAEM,IAAAA;AAAF,MAAW,MAAMZ,KAAK,CAACkB,GAAN,CAAU,mBAAV,CAAvB;AACA,SAAO;AAAEN,IAAAA;AAAF,GAAP;AACD,CAHM;;AAKP,MAAMK,YAAY,GAAG,CAACb,GAAD,EAAMe,IAAN,KAAe;AAClC,MAAIf,GAAJ,EAAS;AACPA,IAAAA,GAAG,CAACgB,QAAJ,CAAa,GAAb,EAAkBD,IAAlB;AACAf,IAAAA,GAAG,CAACiB,QAAJ,GAAe,IAAf;AACA,WAAO,EAAP;AACD;;AACDtB,EAAAA,MAAM,CAACuB,OAAP,CAAeH,IAAf;AACA,SAAO,EAAP;AACD,CARD","sourcesContent":["import Router from \"next/router\";\nimport axios from \"axios\";\n\nexport const authInitialProps = (isProtectedRoute) => ({ req, res }) => {\n  const auth = getSessionFromServer();\n  const currentPath = req ? req.url : window.location.pathname;\n  const user = auth.data;\n  const userId = user.id;\n  const isAnonymous = !user;\n  if (isProtectedRoute && isAnonymous && currentPath !== \"/signin\") {\n    return redirectUser(res, \"/signin\");\n  }\n  return { auth, userId };\n};\n\nexport const getSessionFromServer = async () => {\n  const { user } = await axios.get(\"users/currentuser\");\n  return { user };\n};\n\nconst redirectUser = (res, path) => {\n  if (res) {\n    res.redirect(302, path);\n    res.finished = true;\n    return {};\n  }\n  Router.replace(path);\n  return {};\n};\n"]},"metadata":{},"sourceType":"module"}